# YOLO + Toio 联合控制系统

这个程序将YOLO视觉检测和toio机器人控制结合在一起，实现当检测到机器人离开指定圆形区域时自动执行特殊动作。

## 功能特点

- **实时视觉检测**：使用YOLO模型检测toio机器人的位置
- **圆形区域监控**：设定一个虚拟圆形区域，监控机器人是否在区域内
- **自动响应**：当检测到机器人离开圆形区域时，自动触发该机器人执行特殊动作
- **多机器人支持**：同时控制3个toio机器人（ID: 0, 1, 2）
- **视觉反馈**：实时显示检测画面，不同颜色标识机器人状态

## 系统架构

1. **YOLO检测线程**：在单独线程中运行，负责视觉检测
2. **Toio控制异步任务**：使用asyncio管理多个机器人的控制
3. **事件队列**：连接YOLO检测和toio控制的桥梁

## 工作流程

1. 程序启动时初始化YOLO模型和摄像头
2. 连接3个toio设备，分别设置为红、绿、蓝色LED
3. 所有toio开始随机移动
4. YOLO持续检测机器人位置
5. 当检测到某个机器人离开圆形区域时：
   - YOLO发送离开事件到队列
   - 对应的toio控制器接收事件
   - 该toio执行特殊动作（原地转180度，然后前进1秒）
   - 完成后恢复随机移动

## 使用方法

1. 确保已安装所有依赖包
2. 将3个toio机器人开机
3. 运行程序：
   ```bash
   python combined_yolo_toio_control.py
   ```
4. 程序会自动连接设备并开始运行
5. 在YOLO检测窗口中可以看到实时画面
6. 按 'q' 键退出程序

## 配置参数

在 `combined_yolo_toio_control.py` 中可以调整以下参数：

### YOLO参数
- `MODEL_PATH`: YOLO模型文件路径
- `CAMERA_INDEX`: 摄像头索引（默认为1）
- `CONF_THRESHOLD`: 检测置信度阈值

### 圆形区域参数
- `CIRCLE_CENTER_X/Y`: 圆心坐标
- `CIRCLE_RADIUS`: 圆形半径

## 显示说明

- **绿色圆圈**：监控区域边界
- **机器人边框**：
  - 蓝色：在圆圈内
  - 红色：在圆圈外
- **ID标签**：显示每个机器人的ID（0, 1, 2）

## 注意事项

1. 确保只有3个toio设备开机
2. 摄像头需要能清楚看到所有toio机器人
3. 如果连接失败，程序会自动重试3次
4. YOLO模型文件需要放在正确路径 